"0","binary_data <- data_gathered %>% "
"0","  filter(variable %in% binary_vars) %>% "
"0","  mutate(value = as.integer(value))"
"0","binary_arranged <- binary_data %>% "
"0","  group_by(description) %>% "
"0","  mutate(num_yes = sum(value)) %>% "
"0","  ungroup() %>% "
"0","  arrange(num_yes) %>% "
"0","  mutate(description = fct_inorder(factor(description)))"
"0","  "
"0","legend_data <- binary_arranged %>% "
"0","  group_by(description) %>% "
"0","  summarise(num_yes = first(num_yes)) %>% "
"0","  ungroup() %>% "
"0","  tail(1) %>% {"
"0","    new_df <- rbind(.,.)"
"0","    new_df$num_yes[1] = 0"
"0","    new_df"
"0","  } %>% "
"0","  mutate(label = c('yes', 'no'))"
"0","binary_arranged %>%  "
"0","  mutate(value = ifelse(value == 1, 'yes', 'no')) %>% "
"0","  ggplot(aes(x = description)) +"
"0","  geom_bar(aes(fill = value), position = 'stack') +"
"0","  geom_text("
"0","    data = legend_data, "
"0","    aes(y = num_yes, label = label), "
"0","    hjust = 0, nudge_y = 5, color = '#525252') +"
"0","  coord_flip() +"
"0","  guides(fill = FALSE) +"
"0","  labs(x = '')"
